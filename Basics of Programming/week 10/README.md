# [语言月赛202305] 你的牌太多了 2

## 题目背景

相信你对笨蛋扶苏和坏蛋小 F 打牌的[故事](https://www.luogu.com.cn/problem/B3745)记忆犹新。这次，她们又在打一种很新的牌。

## 题目描述

初始时，扶苏和小 F 手中各有 $n$ 张牌。每张牌有一个花色 $f$ 和一个点数 $p$。在本题中，花色是不超过 $m$ 的正整数，点数是不超过 $r$ 的正整数。

我们定义『一轮出牌』是指从某人开始出牌，双方轮流按规则打出手中的手牌，直到一方打不出符合要求的手牌结束。

在一轮出牌中，第一个出牌的人会打出**点数最小**的那张手牌。如果有多张手牌点数最小，则打出**点数最小且花色最小的那张手牌**。然后双方轮流出牌，规则是打出手中**花色与对方刚才打出的牌相同且点数大于对方的刚才打出的牌的点数中，点数最小的那张牌**。如果这样的牌不存在，那么本轮游戏结束，且下一轮由**对方**先出牌（即，本轮最后一手出牌的人下一轮先出）。

现在，给出双方的手牌和第一轮出牌的人，请你求出谁先打完手里的牌。

## 输入格式

**本题单测试点内有多组测试数据**。

输入的第一行是一个整数，表示测试数据的组数 $T$。接下来依次给出每组数据的输入信息：

第一行是四个整数，表示一个人的手牌数 $n$，花色的上界 $m$ ，点数的上界 $r$ 和第一轮出牌的人 $s$。$s = 1$ 表示扶苏先出牌，$s = 2$ 表示小 F 先出牌。  
第二行有 $n$ 个整数，第 $i$ 个整数表示扶苏第 $i$ 张牌的花色 $f1_i$。  
第三行有 $n$ 个整数，第 $i$ 个整数表示扶苏第 $i$ 张牌的点数 $p1_i$。  
第四行有 $n$ 个整数，第 $i$ 个整数表示小 F 第 $i$ 张牌的花色 $f2_i$。  
第五行有 $n$ 个整数，第 $i$ 个整数表示小 F 第 $i$ 张牌的点数 $p2_i$。

## 输出格式

对每组数据，输出一行一个字符串。如果扶苏先打完手里的牌，请输出 `FS wins!`；如果小 F 先打完手里的牌，请输出 `FR wins!`。

## 样例 #1

### 样例输入 #1

```
1
3 1 2 1
1 1 1
1 2 1
1 1 1
2 2 1
```

### 样例输出 #1

```
FS wins!
```

## 样例 #2

### 样例输入 #2

```
1
3 1 2 2
1 1 1
1 2 1
1 1 1
2 2 1
```

### 样例输出 #2

```
FR wins!
```

## 提示

## 数据规模与约定

- 对于 $10\%$ 的数据，$r = 1$；
- 对于 $20\%$ 的数据，$n = 1$；
- 对于 $50\%$ 的数据，$m = 1$；
- 对于 $100\%$ 的数据，$1 \leq T \leq 10$，$1 \leq n,m,r \leq 100$，$1 \leq s \leq 2$，$1 \leq f1_i, f2_i \leq m$，$1 \leq p1_i, p2_i \leq r$。



# [GESP202306 四级] 图像压缩

## 题目描述

图像是由很多的像素点组成的。如果用 $0$ 表示黑，$255$ 表示白，$0$ 和 $255$ 之间的值代表不同程度的灰色，则可以用一个字节表达一个像素（取值范围为十进制 `0-255`、十六进制 `00-FF`）。这样的像素组成的图像，称为 $256$ 级灰阶的灰度图像。

现在希望将 $256$ 级灰阶的灰度图像压缩为 $16$ 级灰阶，即每个像素的取值范围为十进制 `0-15`、十六进制 `0-F`。压缩规则为：统计出每种灰阶的数量，取数量最多的前 $16$ 种灰阶（如某种灰阶的数量与另外一种灰阶的数量相同，则以灰阶值从小到大为序），分别编号 `0-F`（最多的编号为 `0`，以此类推）。其他灰阶转换到最近的 $16$ 种灰阶之一，将某个点的灰阶值（灰度，而非次数）与 $16$ 种灰阶中的一种相减，绝对值最小即为最近，如果绝对值相等，则编号较小的灰阶更近。

## 输入格式

输入第 $1$ 行为一个正整数 $n(10\le n \le 20)$，表示接下来有 $n$ 行数据组成一副 $256$ 级灰阶的灰度图像。

第 $2$ 行开始的 $n$ 行，每行为长度相等且为偶数的字符串，每两个字符用十六进制表示一个像素。约定输入的灰度图像至少有 $16$ 种灰阶。约定每行最多 $20$ 个像素。

## 输出格式

第一行输出压缩选定的 $16$ 种灰阶的十六进制编码，共计 $32$ 个字符。

第二行开始的 $n$ 行，输出压缩后的图像，每个像素一位十六进制数表示压缩后的灰阶值。

## 样例 #1

### 样例输入 #1

```
10
00FFCFAB00FFAC09071B5CCFAB76
00AFCBAB11FFAB09981D34CFAF56
01BFCEAB00FFAC0907F25FCFBA65
10FBCBAB11FFAB09981DF4CFCA67
00FFCBFB00FFAC0907A25CCFFC76
00FFCBAB1CFFCB09FC1AC4CFCF67
01FCCBAB00FFAC0F071A54CFBA65
10EFCBAB11FFAB09981B34CFCF67
01FFCBAB00FFAC0F071054CFAC76
1000CBAB11FFAB0A981B84CFCF66
```

### 样例输出 #1

```
ABCFFF00CB09AC07101198011B6776FC
321032657CD10E
36409205ACC16D
B41032657FD16D
8F409205ACF14D
324F326570D1FE
3240C245FC411D
BF4032687CD16D
8F409205ACC11D
B240326878D16E
83409205ACE11D
```

## 提示

【样例 $1$ 解释】

灰阶 `AB`、`CF` 和 `FF` 出现 $14$ 次，`00` 出现 $10$ 次，`CB` 出现
$9$ 次，`09` 出现 $7$ 次，`AC` 出现 $6$ 次，`07` 出现 $5$ 次，`10`、`11`
和 `98` 出现 $4$ 次，`01`、`1B`、`67`、`76` 和 `FC` 出现 $3$ 次。